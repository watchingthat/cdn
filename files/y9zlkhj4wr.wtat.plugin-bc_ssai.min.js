var wtAdTracer=function(){"use strict";function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}function s(t,e){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return(s=s.call(t)).next.bind(s);if(Array.isArray(t)||(s=function(t,e){if(t){if("string"==typeof t)return n(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=0;function o(t){return"__private_"+i+++"_"+t}function a(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var r,l=function(){function t(){this.player=void 0,this.utils=void 0,this.SHORT_NAME="Must be implemented",this.PLAYER_EVENTS={}}var e=t.prototype;return e.start=function(){},e.getVideoSlot=function(){},e.getMediaId=function(){},e.getPlayerId=function(){},e.getPlayerVersion=function(){},e.getAdBlock=function(){},e.getAdMgV=function(){},e.getIdx=function(){},e.getPercentViewable=function(){},e.getIsLive=function(){},t}(),d={endpoint:"https://y9zlkhj4wr.ey8jd.com/v5/in",batchSize:5,batchInterval:1e3,debug:!1},c={0:[]},u=0,g=!1,p=!1,y=function(){if(d.debug)try{for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.warn.apply(null,["%cWTAT.stream","background:#ffd400;color:#000;padding:2px"].concat(e))}catch(t){}};function f(){d.batchInterval>0&&(r=setInterval(h,d.batchInterval))}function v(){clearInterval(r)}function h(){if(!g){g=!0,v();var t=u;c[u+1]=[],u++,c[t].length&&function(t,e){y("sending",t);try{var n=JSON.stringify(t);if(navigator.sendBeacon){var s=new FormData;s.append("batch",n),s.append("apiKey",d.apiKey),navigator.sendBeacon(d.endpoint,s)||y("beacon queue error"),m(e)}else{var i=new XMLHttpRequest;i.open("POST",d.endpoint,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.setRequestHeader("x-api-key",d.apiKey),i.setRequestHeader("Connection","keep-alive"),i.onreadystatechange=function(){m(e)},i.send("batch="+encodeURIComponent(n))}}catch(t){y("xhr error",t.message)}}(c[t],t),g=!1,f()}}function m(t){delete c[t]}var w=function(){function t(t){void 0===t&&(t={}),d=Object.assign(d,t),f()}var e=t.prototype;return e.push=function(t){!p&&t&&(y("received",t),c[u].push(t),c[u].length>=d.batchSize&&h())},e.stop=function(){p=!0,c[u].length&&h(),v()},t}(),b=function(t,e){var n,s=this;this.options={debug:!1,sendAllCustom:!1},this.sessionId=void 0,this.loopIdx=0,this.staticData={},this.sessionFlags={},this.env={},this.stream=void 0,this.createGuid=function(){for(var t="",e=0;e<12;e++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXZY01234567890".charAt(Math.floor(64*Math.random()));return Date.now()+"-"+t},this.createSession=function(){var t,e,n=!1;try{n=!!window.top.innerWidth||!!window.top.document.documentElement.clientWidth||!!window.top.document.body.clientWidth}catch(t){}s.sessionFlags={firstTimeDataSent:!1,isFif:n,sessionStartTime:Date.now()},s.sessionId=s.createGuid(),0===s.loopIdx&&(s.playlistId=s.createGuid()),s.loopIdx+=1;var i=function(){var t,e;try{var n=k(window.top);t=n[0],e=n[1]}catch(t){}if(!t){var s=window,i=k(s);t=i[0],e=i[1];try{for(;s.parent&&s!==s.parent;){var o=k(s.parent);t=o[0],e=o[1],s=s.parent}}catch(t){}}return[t,e]}();return s.sessionFlags.ww=i[0],s.sessionFlags.wh=i[1],s.sessionFlags.pu=function(t){var e=document.referrer;!e&&t&&(e=document.documentURI);try{var n;(window.location===window.parent.location||!e&&null!=(n=document)&&null!=(n=n.location)&&n.href)&&(e=document.location.href)}catch(t){}return e}(n),s.staticData={rid:s.sessionId,idx:(null==(t=s.env)||null==t.getIdx?void 0:t.getIdx())||s.loopIdx,plGid:s.playlistId,src:s.options.src,v:s.options.v,plV:null==(e=s.env)||null==e.getPlayerVersion?void 0:e.getPlayerVersion(),fif:+s.sessionFlags.isFif,domain:E(s.sessionFlags.pu)},s.sessionId},this.sendData=function(t){s.stream.push(s.gatherData(t))},this.gatherData=function(t){var e,n,i;void 0===t&&(t={});var o,a=Object.assign({},t,s.staticData,{mediaId:null==(e=s.env)||null==e.getMediaId?void 0:e.getMediaId(),playerId:null==(n=s.env)||null==n.getPlayerId?void 0:n.getPlayerId(),cst:Date.now()-s.sessionFlags.sessionStartTime,pVisible:P(),isLive:null==(i=s.env)||null==i.getIsLive?void 0:i.getIsLive()});s.sessionFlags.firstTimeDataSent||(s.sessionFlags.firstTimeDataSent=!0,a.cst=0,a.ww=s.sessionFlags.ww,a.wh=s.sessionFlags.wh,a.pu=s.sessionFlags.pu);try{var r=s.env.getVideoSlot();if(r){var l,d;a.per=null!=(l=null==(d=s.env)||null==d.getPercentViewable?void 0:d.getPercentViewable())?l:function(t,e){if(!t)return;try{var n=window.getComputedStyle(t,null),s=n.getPropertyValue("visibility"),i=n.getPropertyValue("display");if("hidden"===s||"none"===i)return 0;try{if(e){var o=k(window.top),a=o[0],r=o[1],l=t.getBoundingClientRect(),d=0,c=0;if(a===1/0||r===1/0)return;var u=F(t,window);try{d=u.bottom<0||u.top>r?0:u.top<r&&u.bottom>r?(r-u.top)/l.height*100:u.top<0&&u.bottom>0?u.bottom/l.height*100:100,c=u.right<0||u.left>a?0:u.left<a&&u.right>a?(a-u.left)/l.width*100:u.left<0&&u.right>0?u.right/l.width*100:100}catch(t){return}return parseInt(c*d/100,10)}}catch(t){}}catch(t){}}(r,s.sessionFlags.isFif);var c=r.getBoundingClientRect();a.w=parseInt(c.width,10),a.h=parseInt(c.height,10)}}catch(t){s.log("gatherData ERROR reading ad WxH:",t.message)}try{var u=A(window,["wtatCustom","fields"],{});Object.keys(u).length&&(a.custom=a.custom||{},Object.entries(u).forEach((function(t){var e=t[0],n=t[1];"function"==typeof n?a.custom[e]=n(a):!s.options.sendAllCustom&&s.sessionFlags.staticCustomSent||(a.custom[e]=n)}))),s.sessionFlags.staticCustomSent=!0}catch(t){s.log("gatherData error",t.message)}if(o=a,!A(window,["wtatCustom","ignoredEvents"],[]).some((function(t){return Object.entries(t).every((function(t){var e=t[0],n=t[1];return A(o,e)===n}))})))return a},this.logger=function(t){return function(){if(s.options.debug)try{for(var e,n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];console.warn.apply(null,["%c"+t+" "+(null!=(e=null==(n=s.env)||null==n.getPlayerId?void 0:n.getPlayerId())?e:""),"background:#ffd400;color:#000;padding:2px"].concat(o))}catch(t){}}},this.options=Object.assign(this.options,t),this.env=e;var i={debug:this.options.debug,apiKey:this.options.apiKey};this.options.wtUrl&&(i.endpoint=this.options.wtUrl),window&&window.wtStream?this.stream=window.wtStream:(this.stream=new w(i),window&&(window.wtStream=this.stream)),this.log=this.logger("WTAT.core",this.options.debug,null==(n=this.env)||null==n.getPlayerId?void 0:n.getPlayerId()),this.log("version",this.options.v)};function A(t,e,n){if(!t)return n;for(var i,o=t,a=s(Array.isArray(e)?e:e.split("."));!(i=a()).done;){var r=i.value;if(void 0===o[r])return n;o=o[r]}return o}function P(){return void 0!==document.visibilityState?Number("visible"===document.visibilityState):void 0!==document.hidden?Number(!document.hidden):void 0}function F(t,e){var n=e,s=e.parent,i={left:0,right:0,top:0,bottom:0};if(t){var o=t.getBoundingClientRect();n!==s&&(i=F(n.frameElement,s)),i={left:o.left+i.left,right:o.right+i.left,top:o.top+i.top,bottom:o.bottom+i.top}}return i}function k(t){var e=1/0,n=1/0;return!isNaN(t.document.body.clientWidth)&&t.document.body.clientWidth>0&&(e=t.document.body.clientWidth),!isNaN(t.document.body.clientHeight)&&t.document.body.clientHeight>0&&(n=t.document.body.clientHeight),t.document.documentElement&&t.document.documentElement.clientWidth&&!isNaN(t.document.documentElement.clientWidth)&&(e=t.document.documentElement.clientWidth),t.document.documentElement&&t.document.documentElement.clientHeight&&!isNaN(t.document.documentElement.clientHeight)&&(n=t.document.documentElement.clientHeight),t.innerWidth&&!isNaN(t.innerWidth)&&(e=Math.min(e,t.innerWidth)),t.innerHeight&&!isNaN(t.innerHeight)&&(n=Math.min(n,t.innerHeight)),[e,n]}function E(t){if(t)try{return new URL(t).hostname}catch(t){}}var O="afs_ads",_=o("getEventData"),I=function(n){var i,o;function r(t,i){var o;if(void 0===i&&(i={}),(o=n.call(this)||this).player=void 0,o.options=void 0,o.sessionFlags={likelyBreak:0,likelyBreakPos:0},o.resetOnLoadStart=!1,o.log=function(){},o.utils=void 0,o.SHORT_NAME="bc-ssai",o._getAdDetails=function(){var t,e=null==(t=o.player.ads)?void 0:t.ad,n=o.player.ssai().currentTimelineState();return console.log(n),{adId:null==e?void 0:e.id,adSys:null==e?void 0:e.system}},o._getAdPod=function(){var t={adMgV:o.getAdMgV()},e=o.player.ads.pod,n=o.player.ads.ad;void 0!==(null==e?void 0:e.index)?(t.adBreak=e.index,o.sessionFlags.likelyBreak=t.adBreak):t.adBreak=o.sessionFlags.likelyBreak,void 0!==(null==n?void 0:n.index)?(t.adBreakPos=n.index,o.sessionFlags.likelyBreakPos=t.adBreakPos):t.adBreakPos=o.sessionFlags.likelyBreakPos,t.adGid=o.utils.sessionId+"-"+t.adBreak+"-"+t.adBreakPos;var s=null==e?void 0:e.ad_count;return o.sessionFlags.totalAds||(o.sessionFlags.totalAds={}),o.sessionFlags.totalAds[t.adBreak]=s,t},o._adError=function(t,e){var n,s={type:"error"};return t&&("string"==typeof t?s.err=t:(s.st=null==t||null==t.getType?void 0:t.getType(),s.err=null==t||null==t.getVastErrorCode?void 0:t.getVastErrorCode(),s.err2=null==t||null==t.getErrorCode?void 0:t.getErrorCode())),Object.assign(s,o._getAdPod(e,!0)),null!=(n=o.sessionFlags)&&null!=(n=n.totalAds)&&n[o.sessionFlags.likelyBreak]?o.sessionFlags.likelyBreakPos<o.sessionFlags.totalAds[o.sessionFlags.likelyBreak]-1?o.sessionFlags.likelyBreakPos++:(o.sessionFlags.likelyBreak++,o.sessionFlags.likelyBreakPos=0):o.sessionFlags.likelyBreakPos++,s},o.PLAYER_EVENTS={loadstart:function(){return o.sessionFlags.resetOnInit&&o.resetState(),o.sessionFlags.resetOnInit=!0,{type:"init",aBl:o.getAdBlock()}},ended:function(){o.resetState()},"ads-request":function(){return{type:"serve",adMgV:o.getAdMgV()}},"ads-pod-started":function(){var t={type:"adBreak"};return Object.assign(t,o._getAdPod()),t},"ads-load":function(){var t={type:"al"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-ad-started":function(){var t={type:"imp"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-impression":function(){var t={type:"imp"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-first-quartile":function(){var t={type:"efq"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-midpoint":function(){var t={type:"esq"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-third-quartile":function(){var t={type:"etq"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-ad-ended":function(){var t={type:"ecp"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),o.sessionFlags.likelyBreakPos++,t},"ads-pod-ended":function(){o.sessionFlags.likelyBreak++,o.sessionFlags.likelyBreakPos=0},"ads-mute":function(){var t={type:"mute"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-unmute":function(){var t={type:"unmute"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-pause":function(){var t={type:"pause"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},"ads-click":function(){var t={type:"adClick"};return Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod()),t},error:function(){var t={type:"error",err:"unknown"};Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod())},aderror:function(){var t={type:"error",err:"unknown"};Object.assign(t,o._getAdDetails()),Object.assign(t,o._getAdPod())},play:function(){if(!o.sessionFlags.play)return o.sessionFlags.play=!0,{type:"play"}},playing:function(){if(!o.sessionFlags.c0)return o.sessionFlags.c0=!0,{type:"c0"}},timeupdate:function(){if(o.sessionFlags.c0){var t=Math.floor(100*o.player.currentTime()/o.player.duration());if(!o.sessionFlags.c95&&t>=95)return o.sessionFlags.c95=!0,o.sessionFlags.c75=!0,o.sessionFlags.c50=!0,o.sessionFlags.c25=!0,{type:"c95"};if(!o.sessionFlags.c75&&t>=75)return o.sessionFlags.c75=!0,o.sessionFlags.c50=!0,o.sessionFlags.c25=!0,{type:"c75"};if(!o.sessionFlags.c50&&t>=50)return o.sessionFlags.c50=!0,o.sessionFlags.c25=!0,{type:"c50"};if(!o.sessionFlags.c25&&t>=25)return o.sessionFlags.c25=!0,{type:"c25"}}}},o.start=function(){o.utils=new b(o.options,e(o)),o.log=o.utils.logger("WTAT."+o.SHORT_NAME),o.resetState(),o._honeyPot();for(var t=0,n=Object.entries(A(window,["wtatCustom","events"],{}));t<n.length;t++){var s=n[t],i=s[0],a=s[1];o.PLAYER_EVENTS[i]?o.PLAYER_EVENTS[i]=[o.PLAYER_EVENTS[i],a]:o.PLAYER_EVENTS[i]=a}Object.keys(o.PLAYER_EVENTS).forEach((function(t){o.player.on(t,o._onPlayerEvent)}))},o.resetState=function(){o.log("resetting state"),o.sessionFlags={likelyBreak:0,likelyBreakPos:0},o.utils.createSession()},Object.defineProperty(e(o),_,{writable:!0,value:function(t,n){var i;if("function"==typeof t)try{i=t(n)}catch(t){o.log("Error executing event listener for",n.type,t.message)}else if(!0===t)i={type:n.type};else if(Array.isArray(t)){i=[];for(var r,l=s(t);!(r=l()).done;){var d=r.value;i.push(a(e(o),_)[_](d,n))}}else i=t;return i}}),o._onPlayerEvent=function(t){if(o.PLAYER_EVENTS[t.type]){var n=a(e(o),_)[_](o.PLAYER_EVENTS[t.type],t);Array.isArray(n)&&(n=Object.assign.apply(Object,n)),n&&(n.type?o.utils.sendData(n):o.log("Encountered an event without a type. Not sending",t.type,n))}else o.log("Untracked player event triggered",t.type,t)},o._honeyPot=function(){var t=document.createElement("div");t.className=O,t.innerHTML="&nbsp;",t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.background="transparent";try{document.body.appendChild(t),o.sessionFlags.honeyPotOk=!0,o.log("ad blocker honeypot installed")}catch(t){o.log("cannot attach honeypot",t.message)}},o.getVideoSlot=function(){return o.player.el()},o.getMediaId=function(){var t,e,n;null!=(t=o.player)&&null!=(t=t.mediainfo)&&t.id&&(e=o.player.mediainfo.id,null!=(n=o.player)&&null!=(n=n.bcinfo)&&n.accountId&&(e=o.player.bcinfo.accountId+":"+e));return e},o.getPlayerId=function(){var t,e,n,s;return null!=(t=o.player)&&null!=(t=t.bcinfo)&&t.accountId&&null!=(e=o.player)&&null!=(e=e.bcinfo)&&e.playerId?o.player.bcinfo.accountId+":"+o.player.bcinfo.playerId:null!=(n=o.player)&&null!=(n=n.options_)&&n["data-account"]&&null!=(s=o.player)&&null!=(s=s.options_)&&s["data-player"]?o.player.options_["data-account"]+":"+o.player.options_["data-player"]:void 0},o.getPlayerVersion=function(){return A(o.player,["bcAnalytics","settings","platformVersion"])},o.getAdBlock=function(){if(!o.sessionFlags.honeyPotOk)return-1;try{var t=document.body.getElementsByClassName(O),e=t[t.length-1];return e&&null!==e.offsetParent&&e.className===O&&0!==e.innerHTML.length&&0!==e.clientHeight?0:1}catch(t){return o.log("error getting ad block status",t.message),-2}},o.getAdMgV=function(){return"ssai"},o.getIsLive=function(){if(void 0===o.sessionFlags.isLive)try{var t;o.sessionFlags.isLive=Number(null==(t=o.player)||null==(t=t.ads)||null==t.isLive?void 0:t.isLive())}catch(t){}return o.sessionFlags.isLive},o.player=t,o.options=i,o.options.src=o.SHORT_NAME,"debug"===o.options.debug)debugger;return o}return o=n,(i=r).prototype=Object.create(o.prototype),i.prototype.constructor=i,t(i,o),r}(l),j={v:"5.8.0"},S={};try{var B=localStorage.getItem("wtDebug"),C=localStorage.getItem("wtUrl");B&&(S.debug=B),C&&(S.wtUrl=C)}catch(t){}function T(t){var e=this;void 0===t&&(t={}),this.ready((function(){var n=Object.assign({},j,t,S);n.wtatCustom&&(window.wtatCustom=window.wtatCustom||{},n.wtatCustom.fields&&(window.wtatCustom.fields=Object.assign({},window.wtatCustom.fields||{},n.wtatCustom.fields)),n.wtatCustom.events&&(window.wtatCustom.events=Object.assign({},window.wtatCustom.events||{},n.wtatCustom.events)),n.wtatCustom.ignoredEvents&&(window.wtatCustom.ignoredEvents=[].concat(window.wtatCustom.ignoredEvents||[],n.wtatCustom.ignoredEvents)),delete n.wtatCustom),new I(e,n).start()}))}return(videojs.registerPlugin||videojs.plugin)("wtAdTracer",T),T}();
